version: '1.0'
steps:
  composition:
    type: composition
    title: Compose with Dbs & run tests
    description: Running tests...
    working_directory: '${{build_image}}'
    composition:
      version: '2'
    composition_candidates:
      mariadb:
        image: node
        command:
          - "node"
          - "-e"
          - "let http = require('http'); http.createServer((req, res) => { console.log('Got request'); res.end('$VAR1 $VAR2') }).listen(3000, () => console.log('Server Started'))"
      api:
        image: 'busybox'
        command: sleep 10
#  push:
#    type: push
#    title: ECR push
#    description: Free text description
#    candidate: ${{build_step_name}}
#    provider: ecr
#    tag: latest
#    accessKeyId: ${{AWS_ACCESS_KEY}}
#    secretAccessKey: ${{AWS_SECRET}}
#    region: eu-central-1
